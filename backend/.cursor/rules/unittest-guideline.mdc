---
description: 
globs: 
alwaysApply: true
---
---
description: 
globs: 
alwaysApply: true
---

# WINITProduct - Unit Testing Guidelines for Module BL

## âœ… Project Structure Summary

The `WINITProduct` project follows a modular architecture. Here's the relevant structure:

```
WINITXUnitTest/
â””â”€â”€ UnitTest/
    â””â”€â”€ Modules/
        â””â”€â”€ {ModuleName}/
            â”œâ”€â”€ BL.Tests/        # Business Layer Unit Tests (keep)
            â””â”€â”€ DL.Tests/        # Data Layer Unit Tests (remove)
```

- Each module (e.g., Route) has:
  - **Model**: Data contracts/interfaces
  - **DL**: Data access logic
  - **BL**: Business logic (focus of unit testing)
- Only `BL.Tests` are needed for unit testing.

---

## âœ… Purpose of Unit Testing in BL

Unit tests should:
- Focus only on **business logic** (BL).
- Use **mocked DL interfaces** to isolate dependencies.
- Avoid database or external system interactions.

---

## ğŸ”„ Promptor Rules / Best Practices

| Step | Rule | Description |
|------|------|-------------|
| 1 | âœ… Use real interfaces and models | Avoid assumptions, always reflect actual code. |
| 2 | âœ… Only mock DL interfaces | e.g., `IRouteDL` with Moq |
| 3 | âœ… Centralize test data | Use `{Module}TestFixture.cs` |
| 4 | âœ… Follow AAA pattern | Arrange â†’ Act â†’ Assert |
| 5 | âœ… Clear test names | e.g., `ShouldReturnPagedResult_WhenValidInput` |
| 6 | âœ… Cover edge cases | Nulls, missing UID, empty results |
| 7 | âœ… Use `Verify()` on mocks | Check method interactions |
| 8 | ğŸš« Skip DL or DB logic testing here | Thatâ€™s for integration tests |
| 9 | âœ… Keep tests isolated | No test should depend on another |
| 10 | âœ… Use test coverage tools | e.g., Coverlet, Visual Studio explorer |

---

## ğŸ“Œ Standard Prompt Template

When generating tests for a new module:

```
"Generate unit tests for `Modules/{Module}/BL` using xUnit. 
Use only business logic classes and mock the DL interfaces. 
Ensure all methods in `{Module}BL.cs` are tested. 
Generate `{Module}TestFixture.cs` using actual model fields only. 
Follow AAA structure and include positive and negative tests."
```

---

## âš ï¸ Common Issue Noted

- **Problem**: Test fixture had fields (`Description`, `FieldName`, etc.) not found in real models.
- **Cause**: Assumptions instead of real model validation.
- **Fix**: Always inspect class definitions before writing fixtures.

---

## âœ… Unit Test Health Checklist

- [ ] Fixtures reflect exact model definitions
- [ ] No direct DB dependencies
- [ ] All business logic paths tested
- [ ] Negative and edge cases covered
- [ ] Mock behaviors verified
- [ ] CI/CD pipeline integrated for test runs

---

## ğŸ”§ Tools to Use

- **xUnit**: Test framework
- **Moq**: Mocking framework
- **FluentAssertions**: Readable assertions (optional)
- **Coverlet**: Code coverage
- **Playwright**: For e2e, not unit testing

---

Let me know if you'd like a reusable starter template or example test generator for other modules.


