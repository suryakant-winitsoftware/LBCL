@using Microsoft.JSInterop
@using Winit.UIModels.Common.GraphModels
@using Newtonsoft.Json
@inject IJSRuntime jsRunTime

<div class="cls_canvas_outline" >
    <canvas id="myBarChart"></canvas>
</div>


@code {
    [Parameter]
    public List<BarChartModel> BarDataSource { get; set; } = new List<BarChartModel>();

    [Parameter]
    public string[] SingleBarLabels { get; set; }

    private string backgroundColor = "#FFFFFF";

    bool isPageRendered { get; set; }

    protected override async Task OnInitializedAsync()
    {
        // await RenderChart();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            isPageRendered = true;
            await RenderChart();
            // Call the JavaScript function to render the chart
        }
    }

    public async Task RenderChart()
    {
        if (isPageRendered)
        {
            var jsonData = JsonConvert.SerializeObject(BarDataSource);
            await jsRunTime.InvokeVoidAsync("BarChart", "myBarChart", jsonData, SingleBarLabels, backgroundColor);
        }
    }
}
